Install Apache Kafka:
=====================

https://kafka.apache.org/downloads


https://www.apache.org/dyn/closer.cgi?path=/kafka/3.2.0/kafka_2.12-3.2.0.tgz


https://dlcdn.apache.org/kafka/3.2.0/kafka_2.12-3.2.0.tgz


cd /home/datamaking/workarea/softwares


wget https://dlcdn.apache.org/kafka/3.2.0/kafka_2.12-3.2.0.tgz


tar -xvzf kafka_2.12-3.2.0.tgz


/home/datamaking/workarea/softwares/kafka_2.12-3.2.0


nano ~/.bashrc

export KAFKA_HOME=/home/datamaking/workarea/softwares/kafka_2.12-3.2.0
export PATH=$PATH:$KAFKA_HOME/bin


source ~/.bashrc


cd /home/datamaking/workarea/softwares/kafka_2.12-3.2.0/config

In /home/datamaking/workarea/softwares/kafka_2.12-3.2.0/config

server.properties

nano server.properties

delete.topic.enable = true



sudo nano /etc/systemd/system/zookeeper.service


[Unit]
Requires=network.target remote-fs.target
After=network.target remote-fs.target

[Service]
Type=simple
User=veera
Environment=JAVA_HOME=/home/veera/data/spark/jdk-11.0.2
ExecStart=/home/veera/data/spark/kafka/bin/zookeeper-server-start.sh /home/veera/data/spark/kafka/config/zookeeper.properties
ExecStop=/home/veera/data/spark/kafka/bin/zookeeper-server-stop.sh
Restart=on-abnormal

[Install]
WantedBy=multi-user.target


sudo nano /etc/systemd/system/kafka.service


[Unit]
Requires=zookeeper.service
After=zookeeper.service

[Service]
Type=simple
User=veera
Environment=JAVA_HOME=/home/veera/data/spark/jdk-11.0.2
ExecStart=/bin/sh -c '/home/veera/data/spark/kafka/bin/kafka-server-start.sh /home/veera/data/spark/kafka/config/server.properties > /home/veera/data/spark/kafka/logs/kafka.log 2>&1'
ExecStop=/home/veera/data/spark/kafka/bin/kafka-server-stop.sh
Restart=on-abnormal

[Install]
WantedBy=multi-user.target



sudo systemctl start zookeeper


sudo systemctl start kafka


for zookeeper
netstat -an | grep 2181


Command 'netstat' not found, but can be installed with:

sudo apt install net-tools

for kafka
netstat -an | grep 9092


jps

Checking the status of the Zookeeper service:
---------------------------------------------

sudo systemctl status zookeeper


Checking the status of the Kafka service:
-----------------------------------------

sudo systemctl status kafka


Command to start the Zookeeper service:
---------------------------------------

sudo systemctl start zookeeper


Command to start the Kafka service:
-----------------------------------

sudo systemctl start kafka


Command to stop the Zookeeper service:
--------------------------------------

sudo systemctl stop zookeeper


Command to stop the Kafka service:
----------------------------------

sudo systemctl stop kafka


netstat -an | grep 2181

netstat -an | grep 9092


Command to create Kafka topic:
------------------------------

kafka-topics.sh --create --topic order-events --bootstrap-server localhost:9092

kafka-topics.sh --create --topic output-topic --bootstrap-server localhost:9092

kafka-topics.sh --create --topic test-topic --bootstrap-server localhost:9092


Describe kafka topic:
---------------------

kafka-topics.sh --describe --topic order-events --bootstrap-server localhost:9092

kafka-topics.sh --describe --topic output-topic --bootstrap-server localhost:9092


List the kafka topics:
----------------------

kafka-topics.sh --list --bootstrap-server localhost:9092



kafka-topics.sh --bootstrap-server localhost:9092 --topic output-topic --delete


Commandline kafka producer:
---------------------------

kafka-console-producer.sh --topic order-events --bootstrap-server localhost:9092

kafka-console-producer.sh --topic test-topic --bootstrap-server localhost:9092


Commandline kafka consumer:
---------------------------

kafka-console-consumer.sh --topic order-events --from-beginning --bootstrap-server localhost:9092
kafka-console-consumer.sh --topic order-events --bootstrap-server localhost:9092 (fresh content onlyy)


kafka-console-consumer.sh --topic output-topic --from-beginning --bootstrap-server localhost:9092


kafka-console-consumer.sh --topic test-topic --from-beginning --bootstrap-server localhost:9092

every time i started the consumer kafka-console-consumer.sh --topic order-events --from-beginning --bootstrap-server localhost:9092 
the data is showing why? even though i have run the produecer code long back?

answer : 
The --from-beginning flag in the kafka-console-consumer.sh command means that the consumer will start reading messages from the beginning of the topic. 
If you are seeing old data even after restarting the producer, it's likely that the messages were still present in the Kafka topic from the previous runs.

Kafka retains messages for a configurable retention period, and by default, it keeps messages for 7 days. 
If you want to start fresh with a new set of messages each time you run the producer, you have a few options:

Delete the topic:
You can delete the topic before running the producer. This will remove all data associated with that topic.
####### kafka-topics.sh --zookeeper localhost:2181 --delete --topic order-events

After deleting, you can recreate the topic:
#### kafka-topics.sh --zookeeper localhost:2181 --create --topic order-events --partitions 1 --replication-factor 1

2. Adjust retention settings:
If you want to keep the topic but ensure that old messages are removed more quickly, 
you can adjust the retention.ms setting for the topic. This controls the maximum time a message will be retained in the topic.
##kafka-configs.sh --zookeeper localhost:2181 --entity-type topics --entity-name order-events --alter --add-config retention.ms=60000

In this example, retention.ms is set to 60,000 milliseconds (1 minute). Adjust it based on your requirements.

Choose the option that best fits your use case. Keep in mind that deleting a topic will remove all data associated with it, 
and adjusting retention settings affects how long messages are kept in the topic.







